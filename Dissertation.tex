% This document is designed to conform to the style and layout
% guidelines stipulated in the document "Preparing and Filing the
% Thesis or Dissertation" at
% 
% http://www.gradstudies.ucdavis.edu/students/filing.html
% 
% and in the sample dissertation title page at
% 
% http://www.gradstudies.ucdavis.edu/students/sample_title.html
% 
% ---Tyrrell McAllister
%

\input{LayoutPreamble.tex}

\input{MacrosPreamble.tex}

\begin{document}
   \frontmatter

   \pagestyle{prelim}
   
   % Redefine plain page style so that the first pages of chapters
   % have desired page style.
   %
   \fancypagestyle{plain}{%
      \fancyhf{}
      \cfoot{-\thepage-}
   }%
   \input{TitlePage.tex}
   \newpage
   
   % Begin Double Spacing
   %
%   \doublespacing
   
   \tableofcontents
   \newpage
   
   \input{abstract.tex}
   \newpage
   
   \section*{Acknowledgments}
   \input{Acknowledgments.tex}
   
   \mainmatter
   
   \pagestyle{maintext}
   
   % Redefine plain page style so that the first pages of 
   % chapters have desired page style.
   %
   \fancypagestyle{plain}{%
      \renewcommand{\headrulewidth}{0pt}
      \fancyhf{}
      \rhead{\thepage}
   }%
   
   \chapter{Introduction}
   \label{ch:IntroductionLabel}
   \input{Introduction.tex}
   
   %%%%%%%%%%%%%%%%%%%%%%
   \chapter{Background}
   \label{ch:background}
   %\input{background/bg.tex}   
   
   In this chapter, we first review some polyhedral decompositions and how these relate to generating functions for the lattice points of a polyhedra. 
   
\section{Working with generating functions: an example}
 
 Let us start with an easy example. Consider the one dimensional polyhedra in $\R$ given by $\PP = [0, n]$. We encode the latticd points of $\PP \cap \Z$ by placing each integer point as the power of a monomial, there by obtaining the polynomial $S(\PP; z) := z^0 + z + z^2 + z^3 + \cdots + z^n$. The polynomial $S(\PP; z)$ is called the \emph{generating function of $\PP$.} Notice that counting $\PP \cap \Z$ is equivalat to evaluating $S(\PP, 1)$.
 
 In terms of the computational complexity, listing each monomial in the polynomial $S(\PP, z)$ results in a polynomial with exponential length in the bit length of $n$. However, we can rewrite the summation with one term:
 
 \[ S(\PP, z) = z^0 + z^1 + \cdots + z^n = \frac{1-z^{n+1}}{1-z}.\]

Counting the number of point in $|\PP \cap \Z|$ is no longer as simple as evaluating $\frac{1-z^{n+1}}{1-z}$ at $z=1$ because this is a singularity. However, this singularity is removable. One could perform long-polynomial division, but this would result in a expoentially long polynomial in the bit length of $n$. Another option that yeilds a polynomail time algorithm would be to apply L'Hospital's rule:

\[\lim_{z \rightarrow 1} S(\PP, z) = \lim_{z \rightarrow 1} \frac{-(n+1)z^{n}}{1} = n+1. \]

Notice that $S(\PP, z)$ can be written in two ways:

\[ S(\PP, z) = \frac{1}{1-z} - \frac{z^{n+1}}{1-z} = \frac{1}{1-z} + \frac{z^n}{1-z^{-1}}.\]

The first two rational expressions have a nice description in terms of their series expansion:

\[ 1+z + \cdots + z^n = (z^0 + z^1 + \cdots ) -  (z^{n+1} + z^{n+2} + \cdots).\]

For the secont two rational functions, we have to be careful about the domain of convergence when computing the series expansion. Notice that in the series expansion,

\begin{align*}
\frac{1}{1-z} =& \begin{cases} 
      z^0 + z^1 + z^2 \cdots & \;\;\;\;\; \text{ if } |z| < 1 \\
      -z^{-1} -z^{-2} - z^{-3} - \cdots & \;\;\;\;\; \text{ if }  |z| > 1 
   \end{cases} \\
\frac{z^n}{1-z^{-1}} =& \begin{cases} 
		-z^{n+1} - z^{n+2} - z^{n+3} -\cdots & \text{ if } |z| < 1 \\
      z^{n} + z^{n-1} + z^{n-2} + \cdots & \text{ if }  |z| > 1 
   \end{cases} \\
\end{align*}


adding the terms when $|z| <1$  or $|z| > 1$ results in the desired polynomial: $z^0 + z^1 + \cdots + z^n$. But we can also get the correct polynomial by adding the series that corresponds to different domains of convergence. However, to do this we must now add the series $\cdots + z^{-2} + z^{-1} + 0 + z + z^2 + \cdots$ which corresponds to the polyhedra that is the entire real line:
\begin{align*}
1 + z + \cdots z^n &= (1 + z + z^2 + \cdots)\\
& \quad  + (z^n + z^{n-1} + \cdots)  \\
& \quad - (\cdots + z^{-2} + z^{-1} + 0 + z + z^2 + \cdots)
\end{align*}
and
\begin{align*}
1 + z + \cdots z^n &= (-z^{-1} -z^{-2} - z^{-3} - \cdots)\\
& \quad  + (-z^{n+1} - z^{n+2} - z^{n+3} -\cdots)  \\
& \quad + (\cdots + z^{-2} + z^{-1} + 0 + z + z^2 + \cdots)
\end{align*}

Hence by including the series $\cdots + z^{-2} + z^{-1} + 0 + z + z^2 + \cdots$, we can perform the series expansion of $\frac{1}{1-z} + \frac{z^n}{1-z^{-1}}$ by computing the series expansion of each term on potentially different domains of convergence. 

In the next sections, we will develop rigorous justification for adding the series  $\cdots + z^{-2} + z^{-1} + 0 + z + z^2 + \cdots$.
 
\section{Indicator functions}

\begin{definition} 
The indicator function, $[A]: \R^d \rightarrow \R$, of a set $A \subseteq \R^d$ takes two values: $[A](x) =1$ if $x \in A$ and $[A](x)=0$ otherwise. 
\end{definition} 

The set of indicator functions on $\R^d$ froms a vectorspace with pointwise additions and scalar multiplication. Notice that $[A]\cdot [B] = [A \cap B]$, and $[A]+[B] = [A \cup B] + [A \cap B]$. 

\begin{definition} The \emph{cone} of a set $A \subseteq \R^d$ is all conic combinations of the points from $A$:
\[\Cone(A) := \left\{ \sum_i \alpha_i a_i \mid a_i \in A, \alpha_i \in \R_{\geq 0} \right\} \]
\end{definition} 

\begin{definition} 
Let $\PP$ be a polyhedron and $x \in \PP$. Then the \emph{tangent cone}, of $\PP$ at $x$ is the polyhedral cone 
\[\TCone(\PP, x) := x + \Cone(\PP - x)\]  
\end{definition} 
 
Note that if $x$ is a vertex of $\PP$, and $\PP$ is given by an inequality description, then the tangent cone $\TCone(\PP, x)$ is the intersection of inequalities that are tight at $x$. Also, $\TCone(\PP, x)$ includes the affine hull of the face that $x$ is in, so the tangent cone is pointed only if $x$ is a vertex. 

When $F$ is a face of $\PP$, we will also use the notation $\TCone(\PP, F)$ to denote $\TCone(\PP, x)$ where $x$ is any interior point of $F$.

\begin{theorem}[\cite{brianchon1837}, \cite{gram1871}]
Let $\PP$ be a polyhedron, then 
\[[\PP] = \sum_{F} (-1)^{\dim(F)}[\TCone(\PP, F)] \]
where the sum ranges over all faces $F$ of $\PP$ including $F = \PP$ but excluding $F = \emptyset$
\end{theorem} 

This theorem is saying that if the generating function of a polytope is desired, it is sufficient to just find the generating function for every face of $\PP$. The next
 corollary takes this a step further and says it is sufficient to just construct the generating functions associated at each vertex. This is because, as we will see, the generating functions for non-pointed polyhedra can be ignored.
 
\begin{cor}
\label{cor:tcone-mod-lines}
Let $\PP$ be a polyhedron, then 
\[ [\PP] \equiv \sum_{v \in V} [\TCone(\PP, v)] \pmod{\text{indicator functions of non-pointed polyhedra}},\]
where $V$ is the vertex set of $\PP$.
\end{cor}

\section{Generating functions of simple cones}

In this section, we quickly review the generating function for summation and integration when the polyhedra is a cone. 

%
%\begin{theorem}
%Let $C \subseteq \R^d$ be a simple full-dimensional pointed convex cone (with vertex at $0$) generated by the rays $u_1, \dots, u_d \in \R^d$. Then 
%
%\[ \sum_{\alpha \in C \cap \Z^d}  x^\alpha = \frac{\sum_{a_i \in \Pi \cap \Z^d} x^{a_i}}{\prod_{i=1}^d (1 - x^{u_i})},\]
%
%where $\Pi$ is the half-open fundamental parallelepiped $\Pi = \{ \sum_{i=1}^d \beta_i u_i \mid 0 \leq \beta_i < 1\}. $
%\end{theorem}
%
%It will also be convenient to perform the change of variables $x_i \rightarrow e^{\ell_i}$ where $\ell_i$ is the new variable. We will now exclusively use this new description. 
%
%\begin{cor}
%Let $C \subseteq \R^d$ be a simple full-dimensional pointed convex cone (with vertex at $0$) generated by the rays $u_1, \dots, u_d \in \R^d$. Then 
%
%\[ \sum_{\alpha \in C \cap \Z^d}  e^{\ll \ell, \alpha \rr} = \frac{\sum_{a_i \in \Pi \cap \Z^d} e^{\ll \ell, a_i \rr}}{\prod_{i=1}^d (1 - e^{\ll \ell, u_i \rr})},\]
%
%where $\Pi$ is the half-open fundamental parallelepiped and $\ll \cdot, \cdot \rr$ is the standard dot product in $\R^d$.
%\end{cor}
%
%\begin{theorem}
%Let $C \subseteq \R^d$ be a simple full-dimensional pointed convex cone (with vertex at $0$) generated by the rays $u_1, \dots, u_d \in \R^d$. Then 
%
%\[ \int_{C}  e^{\ll \ell, x \rr} \d x  = \frac{\sum_{a_i \in \Pi \cap \Z^d} x^{a_i}}{\prod_{i=1}^d (1 - x^{u_i})},\]
%
%where $\Pi$ is the half-open fundamental parallelepiped $\Pi = \{ \sum_{i=1}^d \beta_i u_i \mid 0 \leq \beta_i < 1\}. $
%\end{theorem} 
% 
 
The next Proposition serves as a basis for all the summation algorithms we will discus. 

\begin{proposition}[Theorem 13.8 in \cite{barvinokzurichbook}]\label{valuationI}
There exists a unique valuation  $S(\;\cdot\;,\ell)$ which  associates  to every polyhedron
$\PP\subset \R^d$ a meromorphic function in $\ell$ so that the following properties hold 

\begin{enumerate}
\item If $\ell \in \R^d$ such that $e^{\langle \ell, x\rangle}$ is summable over the lattice points of $\PP$, then
$$
S(\PP,\ell)= \sum_{\PP \cap \Z^d} e^{\langle \ell,x\rangle}.
$$

\item For every point $s \in \Z^d$, one has
$$
S(s+\PP,\ell) = e^{\langle \ell,s\rangle}S(\PP,\ell).
$$
\item If $\PP$ contains a straight line, then $S(\PP,\ell)=0$.
\end{enumerate}
\end{proposition}


A consequence of the valuation property is the following fundamental theorem. 
It follows from the Brion--Lasserre--Lawrence--Varchenko decomposition theory of a
polyhedron into the supporting cones at its vertices \cite{beck-haase-sottile:theorema, Brion88,barvinokzurichbook, lasserre-volume1983}.


\begin{lemma} \label{brion-exp} Let $\PP$ be a polyhedron with set of vertices $V(\PP)$. For each
vertex~$s$, let $C_s(\PP)$ be the cone of feasible directions at vertex $s$. Then
\begin{equation*}
S(\PP,\ell)=\sum_{s\in V(\PP)}S(s+C_s(\PP),\ell).
\end{equation*}
\end{lemma}

This last lemma can be identified as the natural result of combining Corollary \ref{cor:tcone-mod-lines} and Proposition \ref{valuationI} part (3). A non-pointed polyhedra is another characterization of  a polyhedra that contain a line.


Note that the cone $C_s(\PP)$ in Lemma~\ref{brion-exp} may not be simplicial, but for simplicial cones there are explicit rational function formulas. As we will see in Proposition~\ref{prop:integral-exp-simplicial}, one can derive an explicit formula for 
the rational function $S(s+C_s(\PP),\ell)$ in terms of the geometry of the cones.

\begin{proposition} 
  \label{prop:integral-exp-simplicial}
  For a simplicial full-dimensional pointed cone $C$ generated by rays $u_1,u_2,\dots u_d$ (with vertex $0$) and for any point $s$
\begin{equation*}
S(s+C,\ell)
=\sum_{a \in (s+\Pi_C) \cap \Z^d} e^{\langle \ell, a
  \rangle} \prod_{i=1}^d \frac1{1- e^{\langle \ell, u_i \rangle}}
\end{equation*}

where $\Pi_c := \{ \sum_{i=1}^d \alpha_i u_i \mid 0 \leq \alpha_i < 1\}$
These identities holds as a meromorphic function of~$\ell$ 
and pointwise for every $\ell$ such that $\langle \ell, u_i \rangle \neq 0$ for
all $u_i$.
\end{proposition}

The continuous generating function for $\PP$ almost mirrors the discrete case. 

\begin{proposition}[Theorem 8.4 in \cite{barvinokzurichbook}]\label{valuationII}
There exists a unique valuation  $I(\;\cdot\;, \ell)$ which  associates  to every polyhedron
$\PP\subset \R^d$ a meromorphic function so that the following properties hold 

\begin{enumerate}
\item If $\ell$ is a linear form such that $e^{\ll \ell, x \rr}$ is integrable over $\PP$ with the standard Lebesgue measure on $\R^d$ , then 
\[ I(\PP,\ell) = \int_\PP e^{\ll \ell, x \rr} \d x\]
\item For every point $s \in \R^d$, one has
\[I(s+\PP, \ell) = e^{\ll \ell, s \rr}I(\PP,\ell).\]
\item If $\PP$ contains a line, then $I(\PP, \ell) = 0$.
\end{enumerate}
\end{proposition}


\begin{lemma}  Let $\PP$ be a polyhedron with set of vertices $V(\PP)$. For each
vertex~$s$, let $C_s(\PP)$ be the cone of feasible directions at vertex $s$. Then
\begin{equation*}
I(\PP,\ell)=\sum_{s\in V(\PP)}I(s+C_s(\PP),\ell).
\end{equation*}
\end{lemma}

Again, this last lemma can be identified as the natural result of combining Corollary \ref{cor:tcone-mod-lines} and Proposition \ref{valuationII} part (3).

\begin{proposition} 
  
  For a simplicial full-dimensional pointed cone $C$ generated by rays $u_1,u_2,\dots u_d$ (with vertex $0$) and for any point $s$
\begin{equation*}
I(s+C,\ell) = \text{vol} (\Pi_C)e^{\ll \ell, s \rr} \prod_{i=1}^d \frac{1}{-\ll \ell, u_i \rr}.
\end{equation*}
These identities holds as a meromorphic function of~$\ell$ 
and pointwise for every $\ell$ such that $\langle \ell, u_i \rangle \neq 0$ for
all $u_i$.
\end{proposition}

\section{Generating function for non-simple cones}

In the last section, we reviewed results that reduced the problem of finding the generating function of $\sum_{x \in \PP \cap \Z^d } e^{\ll \ell, x \rr }$ and $\int_\PP e^{\ll \ell, x \rr} \d x$ of a general polytope $\PP$ to finding the same generating functions of a simplicial cone $C$. This works perfectly if the poltope $\PP$ is simplicial, meaning at every vertex $v$, the cone $\TCone(\PP, v)$ is simplicial. When $\TCone(\PP, v)$ is not simplicial, the solution is to triangulate it.

\begin{definition}
A triangulation of a cone $C$ is the set $\Gamma$ of simplicial cones $C_i$ of the same dimension as the affine hull of $C$ such that
\begin{enumerate}
\item the union of all the simplicial cones in $\Gamma$ is $C$,
\item the intersection of any pair of simplicial cones in $\Gamma$ is a common face of both simplicial cones,
\item and every ray of every simplicial cone is also a ray of $C$.
\end{enumerate}
\end{definition}
  
 Let $C$ be a full-dimensional pointed polyhedral cone, and $\Gamma = \{ C_i \mid i \in I_1\}$ be a triangulation into simplicial cones $C_i$ where $I_1$ is a finite index set. It is true that $C = \cup_{i \in I_1} C_i$, but $[C] = \sum_{i \in I_1} [C_i]$ is false as points on the boundary of two adjacent simplicial cones are counted multiple times. The correct approach is to use the inclusion-exclusion formula:
 
 \[ [C] = \sum_{\emptyset \neq J \subseteq I_1} (-1)^{|J|-1} [\cap_{j \in J} C_j]\]

Also, note that this still holds true when $C$ (and the $C_i$) is shifted by a point $s$. When $|J| \geq 2$, $I(\cap_{j \in J} C_j, \ell) = 0$ as $\cap_{j \in J} C_j$ is not full-dimensional, and the integration is done with respect to the Lebesgue measure on $\R^d$. This leads us to the next lemma.

\begin{lemma}
\label{lemma:integration-triangulation}
For any triangulation $D_s$ of the feasible cone $C_s$ at each of the vertices $s$ of the polytope $\PP$ we have $I(\PP,\ell) = \sum_{s \in V(\PP)} \sum_{C \in D_s} I(s+C,\ell)$
\end{lemma}

Lemma \ref{lemma:integration-triangulation} states that we can triangulate a polytope's feasible cones and apply the integration formulas on each simplicial cone without worrying about shared boundaries among the cones. Note that there is no restriction on how the triangulation is performed. 

More care is needed for the discrete case as $S(\cap_{j \in J} C_j, \ell) \neq 0$ when $|J| \geq 2$. We want to avoid using the inclusion-exclusion formula as it contains exponentially many terms (in size of $|I_1|$). 





the number of lattice points in $\Pi_C \cap \Z^d$ may be exponential in the encoding of $C$. A standard solution to these problems is to compute a triangulation for each cone $C_s$, and then decompose each simplicial cone into unimodular cones via Algorithm \ref{alg:barvinok-dual}.
 
 
   \begin{enumerate}
   \item ex of a line via polynomial
   \item 2d tile case
   \item Brion, tangent cones
   \item Barvinok
   
   \end{enumerate}
   
   
   
   \begin{figure}[h!]
  \caption{A picture of a gull.}
  \centering
    \includegraphics[width=0.5\textwidth]{figures/fruit.jpg}
\end{figure}
   
   
   
   
   
   %%%%%%%%%%%%%%%%%%%%%%%%%%%%%

   \chapter[% 
      Short Title of 2nd Ch.
   ]{% 
      Long Title of Second Chapter
   }%
   \label{ch:2ndChapterLabel}
   \input{2ndChapterFileName.tex}
   
   \appendix

   \chapter[%
      Short Title of Appendix A
   ]{%
      Long Title of Appendix A
   }%
   \label{ch:AppendixALabel}
   \input{AppendixA.tex}
       
   \backmatter
   
   \bibliographystyle{amsalpha-fi-arxlast}
   \bibliography{bibliography/biblio}
\end{document}